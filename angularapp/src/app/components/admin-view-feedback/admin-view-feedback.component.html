<!-- Bootstrap CSS & JS from CDN -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Inline styling for transparent modal background -->
<style>
  .modal-content {
    background-color: rgba(0, 0, 0, 0.95);
    color: white;
  }
</style>

<div class="container mt-4">
  <h2 class="mb-3 text-white">Feedback Received</h2>

  <div class="form-group mb-3">
    <label for="categoryFilter" class="form-label text-white">Filter by Category:</label>
    <select id="categoryFilter" class="form-control" [(ngModel)]="selectedCategory" (change)="filterFeedbacks()">
      <option value="">All</option>
      <option *ngFor="let category of categories" [value]="category">{{ category }}</option>
    </select>
  </div>

  <table class="table table-dark table-bordered table-striped">
    <thead>
      <tr>
        <th>S.No</th>
        <th>Investment</th>
        <th>Category</th>
        <th>Feedback Message</th>
        <th>Posted Date</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngIf="filteredFeedbacks.length === 0">
        <td colspan="6" class="text-center">No data found</td>
      </tr>
      <tr *ngFor="let feedback of filteredFeedbacks; let i = index">
        <td>{{ i + 1 }}</td>
        <td>{{ feedback.investment.name }}</td>
        <td>{{ feedback.category }}</td>
        <td>{{ feedback.feedbackText }}</td>
        <td>{{ feedback.date }}</td>
        <td>
          <button class="btn btn-info btn-sm me-2" (click)="showProfile(feedback.user)">Show Profile</button>
          <button class="btn btn-success btn-sm" (click)="viewInvestmentDetails(feedback.investment)">View Investment Info</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- User Modal -->
<div class="modal fade" id="userModal" tabindex="-1" aria-labelledby="userModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="userModalLabel">User Details</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body text-center">
        <p>User ID: {{ selectedUser?.userId }}</p>
        <p>Username: {{ selectedUser?.username }}</p>
      </div>
      <div class="modal-footer justify-content-center">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Investment Modal -->
<div class="modal fade" id="investmentModal" tabindex="-1" aria-labelledby="investmentModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="investmentModalLabel">Investment Details</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body text-center">
        <p>Name: {{ selectedInvestment?.name }}</p>
        <p>Type: {{ selectedInvestment?.type }}</p>
        <p>Purchase Price: {{ selectedInvestment?.purchasePrice }}</p>
        <p>Current Price: {{ selectedInvestment?.currentPrice }}</p>
        <p>Quantity: {{ selectedInvestment?.quantity }}</p>
        <p>Purchase Date: {{ selectedInvestment?.purchaseDate }}</p>
        <p>Status: {{ selectedInvestment?.status }}</p>
      </div>
      <div class="modal-footer justify-content-center">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>